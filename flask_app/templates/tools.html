{% extends "base.html" %}

{% block title %}AI Tools{% endblock %}

{% block header %}AI Tools{% endblock %}

{% block content %}
<div class="tools-container">
    <div class="tools-grid">
        <!-- Text Analysis Tool -->
        <div class="tool-card">
            <div class="tool-header">
                <span class="mdi mdi-text-recognition"></span>
                <h3>Text Analysis</h3>
            </div>
            <p>Analyze text for sentiment, key topics, and language detection.</p>
            <div class="tool-content">
                <textarea placeholder="Enter text to analyze..." rows="4"></textarea>
                <div class="tool-options">
                    <select>
                        <option value="sentiment">Sentiment Analysis</option>
                        <option value="topics">Topic Extraction</option>
                        <option value="language">Language Detection</option>
                        <option value="summary">Text Summarization</option>
                    </select>
                </div>
                <button class="analyze-btn">
                    <span class="mdi mdi-magnify"></span>
                    Analyze
                </button>
            </div>
            <div class="tool-result hidden">
                <h4>Analysis Result</h4>
                <div class="result-content"></div>
            </div>
        </div>

        <!-- Image Processing Tool -->
        <div class="tool-card">
            <div class="tool-header">
                <span class="mdi mdi-image-edit"></span>
                <h3>Image Processing</h3>
            </div>
            <p>Process and analyze images using AI.</p>
            <div class="tool-content">
                <div class="image-upload-area">
                    <input type="file" id="imageInput" accept="image/*" hidden>
                    <label for="imageInput">
                        <span class="mdi mdi-upload"></span>
                        <span>Drop image here or click to upload</span>
                    </label>
                </div>
                <div class="tool-options">
                    <select>
                        <option value="object">Object Detection</option>
                        <option value="caption">Image Captioning</option>
                        <option value="style">Style Transfer</option>
                        <option value="enhance">Image Enhancement</option>
                    </select>
                </div>
                <button class="analyze-btn" disabled>
                    <span class="mdi mdi-image-search"></span>
                    Process Image
                </button>
            </div>
            <div class="tool-result hidden">
                <h4>Processing Result</h4>
                <div class="result-content"></div>
            </div>
        </div>

        <!-- Data Analysis Tool -->
        <div class="tool-card">
            <div class="tool-header">
                <span class="mdi mdi-chart-box"></span>
                <h3>Data Analysis</h3>
            </div>
            <p>Analyze datasets and generate insights using AI.</p>
            <div class="tool-content">
                <div class="data-upload-area">
                    <input type="file" id="dataInput" accept=".csv,.json,.xlsx" hidden>
                    <label for="dataInput">
                        <span class="mdi mdi-upload"></span>
                        <span>Upload dataset (CSV, JSON, XLSX)</span>
                    </label>
                </div>
                <div class="tool-options">
                    <select>
                        <option value="stats">Statistical Analysis</option>
                        <option value="viz">Data Visualization</option>
                        <option value="predict">Predictive Analysis</option>
                        <option value="cluster">Clustering Analysis</option>
                    </select>
                </div>
                <button class="analyze-btn" disabled>
                    <span class="mdi mdi-chart-scatter-plot"></span>
                    Analyze Data
                </button>
            </div>
            <div class="tool-result hidden">
                <h4>Analysis Result</h4>
                <div class="result-content"></div>
            </div>
        </div>

        <!-- Translation Tool -->
        <div class="tool-card">
            <div class="tool-header">
                <span class="mdi mdi-translate"></span>
                <h3>Translation</h3>
            </div>
            <p>Translate text between multiple languages.</p>
            <div class="tool-content">
                <div class="translation-options">
                    <select class="from-lang">
                        <option value="auto">Detect Language</option>
                        <option value="en">English</option>
                        <option value="es">Spanish</option>
                        <option value="fr">French</option>
                        <option value="de">German</option>
                        <option value="it">Italian</option>
                        <option value="pt">Portuguese</option>
                        <option value="ru">Russian</option>
                        <option value="ja">Japanese</option>
                        <option value="ko">Korean</option>
                        <option value="zh">Chinese</option>
                    </select>
                    <button class="swap-btn">
                        <span class="mdi mdi-swap-horizontal"></span>
                    </button>
                    <select class="to-lang">
                        <option value="en">English</option>
                        <option value="es">Spanish</option>
                        <option value="fr">French</option>
                        <option value="de">German</option>
                        <option value="it">Italian</option>
                        <option value="pt">Portuguese</option>
                        <option value="ru">Russian</option>
                        <option value="ja">Japanese</option>
                        <option value="ko">Korean</option>
                        <option value="zh">Chinese</option>
                    </select>
                </div>
                <textarea placeholder="Enter text to translate..." rows="4"></textarea>
                <button class="analyze-btn">
                    <span class="mdi mdi-translate"></span>
                    Translate
                </button>
            </div>
            <div class="tool-result hidden">
                <h4>Translation</h4>
                <div class="result-content"></div>
            </div>
        </div>
    </div>
</div>

<style>
.tools-container {
    padding: var(--spacing-lg);
}

.tools-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: var(--spacing-lg);
}

.tool-card {
    background-color: var(--secondary);
    border-radius: var(--radius-lg);
    padding: var(--spacing-lg);
    display: flex;
    flex-direction: column;
    gap: var(--spacing-md);
}

.tool-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-md);
}

.tool-header span.mdi {
    font-size: 2rem;
    color: var(--accent);
}

.tool-header h3 {
    margin: 0;
    font-size: 1.25rem;
}

.tool-card p {
    color: var(--text-muted);
    margin: 0;
}

.tool-content {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-md);
}

.tool-options {
    display: flex;
    gap: var(--spacing-md);
}

.tool-options select,
.translation-options select {
    flex: 1;
    padding: var(--spacing-sm) var(--spacing-md);
    background-color: var(--primary);
    border: none;
    border-radius: var(--radius-md);
    color: var(--text);
}

textarea {
    width: 100%;
    padding: var(--spacing-md);
    background-color: var(--primary);
    border: none;
    border-radius: var(--radius-md);
    color: var(--text);
    resize: vertical;
}

.image-upload-area,
.data-upload-area {
    border: 2px dashed var(--accent);
    border-radius: var(--radius-md);
    padding: var(--spacing-xl);
    text-align: center;
    cursor: pointer;
    transition: all var(--transition-speed) var(--transition-ease);
}

.image-upload-area:hover,
.data-upload-area:hover {
    border-color: var(--text);
    background-color: var(--primary);
}

.image-upload-area label,
.data-upload-area label {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--spacing-sm);
    cursor: pointer;
}

.image-upload-area span.mdi,
.data-upload-area span.mdi {
    font-size: 2rem;
    color: var(--accent);
}

.analyze-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--spacing-sm);
    padding: var(--spacing-md);
    background-color: var(--accent);
    color: var(--secondary);
    border: none;
    border-radius: var(--radius-md);
    cursor: pointer;
    transition: all var(--transition-speed) var(--transition-ease);
}

.analyze-btn:hover {
    filter: brightness(1.1);
}

.analyze-btn:disabled {
    background-color: var(--text-muted);
    cursor: not-allowed;
}

.translation-options {
    display: flex;
    align-items: center;
    gap: var(--spacing-md);
}

.swap-btn {
    padding: var(--spacing-sm);
    background-color: var(--primary);
    border: none;
    border-radius: var(--radius-md);
    cursor: pointer;
    transition: all var(--transition-speed) var(--transition-ease);
}

.swap-btn:hover {
    background-color: var(--accent);
    color: var(--secondary);
}

.tool-result {
    background-color: var(--primary);
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
}

.tool-result h4 {
    margin: 0 0 var(--spacing-sm);
    font-size: 1rem;
}

.hidden {
    display: none;
}

@media (max-width: 768px) {
    .tools-grid {
        grid-template-columns: 1fr;
    }
}
</style>

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', () => {
    // Handle file inputs
    const imageInput = document.getElementById('imageInput');
    const dataInput = document.getElementById('dataInput');
    
    [imageInput, dataInput].forEach(input => {
        if (!input) return;
        
        const button = input.closest('.tool-card').querySelector('.analyze-btn');
        
        input.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                button.disabled = false;
            } else {
                button.disabled = true;
            }
        });
    });
    
    // Handle analyze buttons
    document.querySelectorAll('.analyze-btn').forEach(button => {
        button.addEventListener('click', async (e) => {
            const card = button.closest('.tool-card');
            const content = card.querySelector('.tool-content');
            const result = card.querySelector('.tool-result');
            const resultContent = result.querySelector('.result-content');
            
            // Show loading state
            button.disabled = true;
            button.innerHTML = '<span class="mdi mdi-loading mdi-spin"></span> Processing...';
            
            try {
                // Get tool type and options
                const toolType = card.querySelector('select').value;
                let data = {};
                
                if (card.querySelector('textarea')) {
                    data.text = card.querySelector('textarea').value;
                }
                
                if (card.querySelector('input[type="file"]')) {
                    const file = card.querySelector('input[type="file"]').files[0];
                    if (file) {
                        data.file = file;
                    }
                }
                
                // Add translation-specific data
                if (card.querySelector('.translation-options')) {
                    data.fromLang = card.querySelector('.from-lang').value;
                    data.toLang = card.querySelector('.to-lang').value;
                }
                
                // Make API call
                const response = await fetch(`/api/analyze`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        tool: toolType,
                        ...data
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    result.classList.remove('hidden');
                    resultContent.innerHTML = `<pre>${JSON.stringify(data.analysis, null, 2)}</pre>`;
                } else {
                    throw new Error('Analysis failed');
                }
            } catch (error) {
                console.error('Analysis error:', error);
                result.classList.remove('hidden');
                resultContent.innerHTML = `<div class="error">Error: ${error.message}</div>`;
            } finally {
                // Reset button state
                button.disabled = false;
                button.innerHTML = button.dataset.originalHtml || button.innerHTML;
            }
        });
    });
    
    // Handle language swap
    const swapBtn = document.querySelector('.swap-btn');
    if (swapBtn) {
        swapBtn.addEventListener('click', () => {
            const fromLang = document.querySelector('.from-lang');
            const toLang = document.querySelector('.to-lang');
            const temp = fromLang.value;
            
            if (temp !== 'auto') {
                fromLang.value = toLang.value;
                toLang.value = temp;
            }
        });
    }
});
</script>
{% endblock %}
{% endblock %} 